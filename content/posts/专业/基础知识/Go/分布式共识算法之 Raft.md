---
title: "分布式共识算法之 Raft"
date: 2025-09-23T23:29:15+08:00
lastmod: 2025-09-23T23:29:15+08:00
draft: true
tags: 
categories:
author: 小石堆
---
## 什么是 Raft？
Raft 是分布式系统中的一种分布式共识算法，其目标是让分布式集群中的节点就某项日志达成共识。
## Raft 选主流程？
首先 Raft 中有三个角色，leader、can 以及 fo，分别代表主、候选人以及跟随者。分两种情况，一种是系统初始的时候，Raft 的选主和系统中某个 leader 退位后，他的选主流程。首先，假设系统中有五个节点，这五个节点会一起开启一个选举倒计时器，他们的选举倒计时器的时间是随机的。然后，当有其中一个节点的选举倒计时器到期，此时，他会升级为 can，然后将自己的 Term（任期）+ 1，在 Raft 中只有任期较大的节点才有可能升级为 Leader。然后，他会向其他几个节点发送拉票信息，其他几个节点收到拉票信息后，会判断这个 can 的 Term 是不是比自己的大，如果比自己的大就发送投票信息，当 can 收到的投票信息大于节点的半数以上，那就会将自己升级为 Leader，而一个 fo 在一个 term 内只能投一票。因为这是系统的初始状态，所以不需要比较日志的新旧程度。Leader 上任后需要定时向 fo 发送自己的心跳来维系关系。假设此时，